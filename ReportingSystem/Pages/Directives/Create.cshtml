@page
@model ReportingSystem.Pages.Directives.CreateModel
@{
    ViewData["Title"] = "Issue Directive";
}

<div class="d-flex justify-content-between align-items-center mt-4 mb-3">
    <h2><i class="bi bi-megaphone"></i> Issue Directive</h2>
    <a asp-page="Index" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left"></i> Back to Directives
    </a>
</div>

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

@if (Model.LinkedReport != null)
{
    <div class="alert alert-info">
        <i class="bi bi-link-45deg"></i> Linked to report:
        <a asp-page="/Reports/Details" asp-route-id="@Model.LinkedReport.Id" class="alert-link">
            @Model.LinkedReport.Title
        </a>
        <span class="badge bg-secondary ms-1">@Model.LinkedReport.Committee.Name</span>
    </div>
}

<div class="card shadow-sm">
    <div class="card-body">
        <form method="post">
            <input type="hidden" asp-for="Directive.RelatedReportId" />

            <div class="row mb-3">
                <div class="col-md-8">
                    <label asp-for="Directive.Title" class="form-label">Title</label>
                    <input asp-for="Directive.Title" class="form-control" placeholder="Enter directive title" />
                    <span asp-validation-for="Directive.Title" class="text-danger"></span>
                </div>
                <div class="col-md-4">
                    <label asp-for="Directive.Priority" class="form-label">Priority</label>
                    <select asp-for="Directive.Priority" class="form-select"
                            asp-items="Html.GetEnumSelectList<ReportingSystem.Models.DirectivePriority>()">
                    </select>
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label asp-for="Directive.DirectiveType" class="form-label">Type</label>
                    <select asp-for="Directive.DirectiveType" class="form-select"
                            asp-items="Html.GetEnumSelectList<ReportingSystem.Models.DirectiveType>()">
                    </select>
                </div>
                <div class="col-md-6">
                    <label asp-for="Directive.TargetCommitteeId" class="form-label">Target Committee</label>
                    <select asp-for="Directive.TargetCommitteeId" class="form-select" asp-items="Model.CommitteeOptions">
                        <option value="">-- Select Committee --</option>
                    </select>
                    <span asp-validation-for="Directive.TargetCommitteeId" class="text-danger"></span>
                </div>
            </div>

            <div class="mb-3">
                <label asp-for="Directive.BodyContent" class="form-label">Directive Content</label>
                <textarea asp-for="Directive.BodyContent" class="form-control" rows="6"
                          placeholder="Enter the directive details..."></textarea>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label asp-for="Directive.Deadline" class="form-label">Deadline (optional)</label>
                    <input asp-for="Directive.Deadline" type="datetime-local" class="form-control" />
                </div>
            </div>

            <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-megaphone"></i> Issue Directive
                </button>
                <a asp-page="Index" class="btn btn-outline-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
